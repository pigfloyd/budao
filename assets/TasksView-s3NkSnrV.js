import{c as y,d as M,u as S,w as j,a as d,b as e,t as f,e as v,f as m,g as B,h as b,v as h,i as q,j as $,F as z,r as U,k as V,l as _,o as i,m as F,n as C,p as D,q as N,s as L}from"./index-ClRQCvpD.js";/**
 * @license lucide-vue-next v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=y("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=y("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-vue-next v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=y("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-vue-next v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=y("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-vue-next v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=y("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-vue-next v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=y("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-vue-next v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=y("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),G={key:0,class:"fixed inset-0 z-50 flex items-end sm:items-center justify-center bg-black/50 backdrop-blur-sm p-4 sm:p-6"},J={class:"bg-white rounded-t-xl sm:rounded-xl w-full max-w-lg shadow-xl max-h-[90vh] overflow-y-auto"},K={class:"flex justify-between items-center p-4 border-b border-gray-100"},Q={class:"text-lg font-bold text-gray-900"},R={class:"grid grid-cols-2 gap-4"},W={class:"max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-2"},Y={key:0,class:"text-gray-400 text-sm"},Z={class:"flex items-center space-x-2 cursor-pointer w-full hover:bg-gray-50 p-1 rounded"},ee=["value"],te={class:"text-sm text-gray-700"},se={class:"pt-4"},le={type:"submit",class:"w-full bg-blue-600 text-white font-medium py-2.5 rounded-lg hover:bg-blue-700 active:bg-blue-800 transition-colors"},oe=M({__name:"TaskForm",props:{modelValue:{type:Boolean},task:{}},emits:["update:modelValue","save"],setup(x,{emit:p}){const r=x,c=p,k=S(),g=V(()=>k.tasks.filter(u=>{var t;return u.id!==((t=r.task)==null?void 0:t.id)})),s=_({title:"",description:"",startDate:"",dueDate:"",priority:"medium",status:"todo",dependencies:[]});j(()=>r.modelValue,u=>{u&&(r.task?s.value={...r.task}:s.value={title:"",description:"",startDate:new Date().toISOString().split("T")[0],dueDate:"",priority:"medium",status:"todo",dependencies:[]})});async function w(){if(s.value.title){if(!r.task){const u=await k.checkSimilarTasks(s.value.title);if(u.length>0&&!confirm(`發現 ${u.length} 個相似任務。是否繼續？`))return}s.value.dependencies||(s.value.dependencies=[]),c("save",s.value),c("update:modelValue",!1)}}return(u,t)=>x.modelValue?(i(),d("div",G,[e("div",J,[e("div",K,[e("h2",Q,f(x.task?"編輯任務":"新建任務"),1),e("button",{onClick:t[0]||(t[0]=l=>u.$emit("update:modelValue",!1)),class:"text-gray-400 hover:text-gray-600"},[v(m(A),{size:20})])]),e("form",{onSubmit:B(w,["prevent"]),class:"p-4 space-y-4"},[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"標題",-1)),b(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.title=l),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all",placeholder:"例如：文獻綜述"},null,512),[[h,s.value.title]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"描述",-1)),b(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.value.description=l),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"},null,512),[[h,s.value.description]])]),e("div",R,[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"開始日期",-1)),b(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>s.value.startDate=l),type:"date",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"},null,512),[[h,s.value.startDate]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"截止日期",-1)),b(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>s.value.dueDate=l),type:"date",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"},null,512),[[h,s.value.dueDate]])])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"優先級",-1)),b(e("select",{"onUpdate:modelValue":t[5]||(t[5]=l=>s.value.priority=l),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"},[...t[11]||(t[11]=[e("option",{value:"low"},"低",-1),e("option",{value:"medium"},"中",-1),e("option",{value:"high"},"高",-1)])],512),[[q,s.value.priority]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"依賴任務",-1)),e("div",W,[g.value.length===0?(i(),d("div",Y,"無其他可用任務")):$("",!0),(i(!0),d(z,null,U(g.value,l=>(i(),d("div",{key:l.id,class:"flex items-center mb-1"},[e("label",Z,[b(e("input",{type:"checkbox",value:l.id,"onUpdate:modelValue":t[6]||(t[6]=o=>s.value.dependencies=o),class:"rounded text-blue-600 focus:ring-blue-500"},null,8,ee),[[F,s.value.dependencies]]),e("span",te,f(l.title),1)])]))),128))])]),e("div",se,[e("button",le,f(x.task?"更新任務":"創建任務"),1)])],32)])])):$("",!0)}}),ae={class:"flex justify-between items-center mb-6"},ne={key:0,class:"text-center py-10 text-gray-500"},ie={key:1,class:"space-y-3"},re={class:"flex items-center space-x-3 flex-1 min-w-0"},ue=["onClick"],de={class:"flex-1 min-w-0"},ce={class:"flex items-center text-xs text-gray-500 mt-1 space-x-2"},me={class:"flex items-center"},pe={class:"flex items-center space-x-2 ml-2"},ye=["onClick"],be=["onClick"],fe=M({__name:"TasksView",setup(x){const p=S(),r=_(!1),c=_(null),k=V(()=>p.tasks),g=V(()=>[...k.value].sort((o,n)=>o.status==="done"&&n.status!=="done"?1:o.status!=="done"&&n.status==="done"?-1:new Date(o.dueDate).getTime()-new Date(n.dueDate).getTime()));function s(){c.value=null,r.value=!0}function w(o){c.value=o,r.value=!0}async function u(o){c.value?await p.updateTask(c.value.id,o):await p.addTask(o)}async function t(o){const n=o.status==="done"?"todo":"done";await p.updateTask(o.id,{status:n})}async function l(o){confirm("確定要刪除此任務嗎？")&&await p.deleteTask(o.id)}return(o,n)=>(i(),d("div",null,[e("div",ae,[n[1]||(n[1]=e("h2",{class:"text-2xl font-bold text-gray-800"},"我的任務",-1)),e("button",{onClick:s,class:"bg-blue-600 text-white p-2 rounded-full shadow-lg hover:bg-blue-700 transition-colors"},[v(m(H),{size:24})])]),g.value.length===0?(i(),d("div",ne,[...n[2]||(n[2]=[e("p",null,"暫無任務，請創建一個開始吧！",-1)])])):(i(),d("div",ie,[(i(!0),d(z,null,U(g.value,a=>(i(),d("div",{key:a.id,class:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex items-center justify-between group"},[e("div",re,[e("button",{onClick:T=>t(a),class:"text-gray-400 hover:text-blue-600 transition-colors"},[a.status==="done"?(i(),C(m(E),{key:0,class:"text-green-500",size:24})):(i(),C(m(I),{key:1,size:24}))],8,ue),e("div",de,[e("h3",{class:D([{"line-through text-gray-400":a.status==="done"},"font-medium text-gray-900 truncate"])},f(a.title),3),e("div",ce,[e("span",me,[v(m(O),{size:12,class:"mr-1"}),N(" "+f(m(L)(new Date(a.dueDate),"yyyy/MM/dd")),1)]),e("span",{class:D([{"bg-red-100 text-red-700":a.priority==="high","bg-yellow-100 text-yellow-700":a.priority==="medium","bg-blue-100 text-blue-700":a.priority==="low"},"px-1.5 py-0.5 rounded text-[10px] uppercase font-bold"])},f(a.priority==="high"?"高":a.priority==="medium"?"中":"低"),3)])])]),e("div",pe,[e("button",{onClick:T=>w(a),class:"p-2 text-gray-400 hover:text-blue-600 rounded-full hover:bg-blue-50 transition-colors"},[v(m(P),{size:18})],8,ye),e("button",{onClick:T=>l(a),class:"p-2 text-gray-400 hover:text-red-600 rounded-full hover:bg-red-50 transition-colors"},[v(m(X),{size:18})],8,be)])]))),128))])),v(oe,{modelValue:r.value,"onUpdate:modelValue":n[0]||(n[0]=a=>r.value=a),task:c.value,onSave:u},null,8,["modelValue","task"])]))}});export{fe as default};
