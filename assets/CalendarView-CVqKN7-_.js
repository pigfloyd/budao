import{c as F,x as p,y as O,z as S,A as $,d as L,u as V,a as u,b as a,t as m,f as d,s as v,e as T,F as _,r as b,j as Y,l as j,k as x,o as h,p as C,B as I,C as q}from"./index-ClRQCvpD.js";/**
 * @license lucide-vue-next v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=F("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=F("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);function N(o,t){const e=p(o);if(isNaN(t))return O(o,NaN);if(!t)return e;const i=e.getDate(),r=O(o,e.getTime());r.setMonth(e.getMonth()+t+1,0);const f=r.getDate();return i>=f?r:(e.setFullYear(r.getFullYear(),r.getMonth(),i),e)}function W(o,t){const e=S(o),i=S(t);return+e==+i}function A(o){const t=p(o),e=t.getMonth();return t.setFullYear(t.getFullYear(),e+1,0),t.setHours(23,59,59,999),t}function G(o,t){const e=p(o.start),i=p(o.end);let r=+e>+i;const f=r?+e:+i,l=r?i:e;l.setHours(0,0,0,0);let D=1;const g=[];for(;+l<=f;)g.push(p(l)),l.setDate(l.getDate()+D),l.setHours(0,0,0,0);return r?g.reverse():g}function J(o){const t=p(o);return t.setDate(1),t.setHours(0,0,0,0),t}function K(o,t){var D,g;const e=$(),i=e.weekStartsOn??((g=(D=e.locale)==null?void 0:D.options)==null?void 0:g.weekStartsOn)??0,r=p(o),f=r.getDay(),l=(f<i?-7:0)+6-(f-i);return r.setDate(r.getDate()+l),r.setHours(23,59,59,999),r}function P(o,t){return N(o,-1)}const Q={class:"space-y-8"},U={class:"flex items-center justify-between mb-4"},X={class:"text-2xl font-bold text-gray-800"},Z={class:"flex items-center space-x-2"},tt={class:"grid grid-cols-7 gap-1 text-center mb-2"},et={class:"grid grid-cols-7 gap-1"},st={class:"space-y-0.5 overflow-hidden h-[calc(100%-1.5rem)]"},nt={key:0},at={class:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 overflow-x-auto"},ot={class:"relative h-auto min-h-[200px]"},rt={class:"flex justify-between text-xs text-gray-400 mb-2 border-b pb-1"},it={class:"relative space-y-2"},ct=["title"],ut=L({__name:"CalendarView",setup(o){const t=V(),e=j(new Date),i=x(()=>{const s=q(J(e.value)),c=K(A(e.value));return G({start:s,end:c})});function r(){e.value=P(e.value)}function f(){e.value=N(e.value,1)}function l(s){return v(s,"M")===v(e.value,"M")}const D=x(()=>{const s=new Map;return t.tasks.forEach(c=>{const n=c.dueDate;s.has(n)||s.set(n,[]),s.get(n).push(c)}),s});function g(s){const c=v(s,"yyyy-MM-dd");return D.value.get(c)||[]}const w=x(()=>t.tasks.length===0?new Date:new Date(Math.min(...t.tasks.map(s=>new Date(s.startDate).getTime())))),M=x(()=>t.tasks.length===0?new Date:new Date(Math.max(...t.tasks.map(s=>new Date(s.dueDate).getTime())))),k=x(()=>{const s=M.value.getTime()-w.value.getTime();return s===0?864e5:s});function z(s){const c=new Date(s.startDate).getTime(),n=new Date(s.dueDate).getTime(),y=w.value.getTime(),B=(c-y)/k.value*100,H=(n-c)/k.value*100;return{left:`${B}%`,width:`${Math.max(H,5)}%`}}return(s,c)=>(h(),u("div",Q,[a("div",null,[a("div",U,[a("h2",X,"日曆 ("+m(d(v)(e.value,"yyyy年MM月"))+")",1),a("div",Z,[a("button",{onClick:r,class:"p-2 hover:bg-gray-100 rounded-full transition-colors"},[T(d(E),{size:20})]),a("button",{onClick:f,class:"p-2 hover:bg-gray-100 rounded-full transition-colors"},[T(d(R),{size:20})])])]),a("div",tt,[(h(),u(_,null,b(["日","一","二","三","四","五","六"],n=>a("div",{key:n,class:"text-xs font-medium text-gray-500"},m(n),1)),64))]),a("div",et,[(h(!0),u(_,null,b(i.value,n=>(h(),u("div",{key:n.toString(),class:C(["aspect-square bg-white border border-gray-100 rounded-lg p-1 relative hover:shadow-md transition-shadow",{"opacity-40":!l(n)}])},[a("span",{class:C(["text-xs text-gray-700 block mb-1",{"font-bold text-blue-600":d(W)(n,new Date)}])},m(d(v)(n,"d")),3),a("div",st,[(h(!0),u(_,null,b(g(n),y=>(h(),u("div",{key:y.id,class:"text-[8px] leading-tight bg-blue-50 text-blue-700 px-1 py-0.5 rounded truncate border border-blue-100"},m(y.title),1))),128))])],2))),128))])]),d(t).tasks.length>0?(h(),u("div",nt,[c[0]||(c[0]=a("h3",{class:"text-lg font-bold mb-4"},"項目時間軸",-1)),a("div",at,[a("div",ot,[a("div",rt,[a("span",null,m(d(v)(w.value,"MM/dd")),1),a("span",null,m(d(v)(M.value,"MM/dd")),1)]),a("div",it,[(h(!0),u(_,null,b(d(t).tasks,(n,y)=>(h(),u("div",{key:n.id,class:"relative h-6 rounded-md bg-indigo-500 text-white text-xs flex items-center px-2 truncate shadow-sm hover:bg-indigo-600 transition-colors cursor-default",style:I(z(n)),title:`${n.title}: ${n.startDate} to ${n.dueDate}`},m(n.title),13,ct))),128))])])])])):Y("",!0)]))}});export{ut as default};
